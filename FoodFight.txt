Food Fight:

2. Gang

Hent ned oppdatert FoodFight fra github:
github.com/PaulSolheim/FoodFight
Pakk ut zip-filen og Åpne prosjektet i Godot
(Skann knappen, finn mappa)

Test Spillet som det er nå,
har du en spiller?
Kan du bevege spilleren med WSAD tastene?

Avslutt spillet

Åpne scenen:
	Scenes/Characters/Players/PlayerM.tscn

Her er spilleren vår, den har en kollisjonssone
og en "Armature" (Skeleton) 
med en Mesh og en AnimationPlayer

La oss lære om AnimationTreePlayer
for å lage glidende overganger
mellom animasjoner.

Åpne scenen: 
	Scenes/Characters/Players/Armatures/Armature-M.tscn
	
Klikk på topp-noden
Klikk + ikonet, skriv "animationt"
Trykk Lag-knappen

Dra Output boksen til høyre side
Ved "Master Player" klikk "Assign"
og velg AnimationPlayer, OK knapp

I AnimationTree vinduet, klikk + for å lage en ny animation
Rename og kall den "IdleAnim"
Klikk load og velg Idle animasjonen

Klikk +, velg "Animation Node"
rename til "RunAnim"
Klikk load og velg Run animasjonen

Dra kobling fra RunAnim til Output
Skru på animasjonen ved å skru på "Active" egenskapen
Ser du at spilleren løper?

Skru av animasjonen ved å skru av "Active"

Klikk +, velg "Blend2"
Klikk +, velg "Blend3"

Flytt de så de er mellom IdleAnim / RunAnim og Output

Blend2:
Koble IdleAnim til Blend2.a
Koble RunAnim til Blend2.b
Koble Blend2 til Output

Skru på Animasjonen
Klikk edit og dra slideren til høyre og venstre
Får du glidende overganger?
Dette kan vi styre i koden vår, veldig nyttig!

Blend3:
Legg til Punch animasjonen, kall den "PunchAnim"
Koble Idle, Run og Punch til Blend3
Koble Blend3 til Output
Klikk edit og dra slideren til høyre og venstre
Ser du hva som skjer? 
(kvartveis = overgang Idle/Run, trekvart = overgang Run/Punch)

Blend4 kan lage overganger mellom 4 animasjoner,
den skal vi ikke bruke.

La oss gå tilbake til Blend2:

Fjern Blend3 og PunchAnim (klikk på toppen, høyreklikk, velg Remove)
Koble IdleAnim til Blend2.a
Koble RunAnim til Blend2.b
Koble Blend2 til Output

Rename Blend2 til "Move"
Ctrl-S for å lagre scenen

Gå til PlayerM scenen i toppen
Klikk på Script

Legg til i _process(delta) funksjonen:
	..
	animate()
	
Lag animate funksjonen:

func animate():
	var animate = $Armature/AnimationTreePlayer
	if motion.length() > BLEND_MINIMUM:
		move_state += RUN_BLEND_AMOUNT
	else:
		move_state -= IDLE_BLEND_AMOUNT
	
	move_state = clamp(move_state, 0, 1)
	
	animate.blend2_node_set_amount("Move", move_state)
	
Gå til toppen, under # animation constants linja
legg til:

const BLEND_MINIMUM = 0.125
const RUN_BLEND_AMOUNT = 0.1
const IDLE_BLEND_AMOUNT = 0.07

# animation variables
var move_state = 0 	# 0 is idle, 1 is run 

Test spillet, ser du at animasjonene har glidende overganger?

For å få kameraet til å følge spilleren
kan vi gå til LevelTemplate scenen
dra "Camera" til "Player"
kameraet skal nå være "under" player noden
Test spillet, du må kanskje 
flytte litt på kameraet i scenen.

Voila! Kommer du hit er det veldig bra!
